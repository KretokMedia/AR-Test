<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AR Place Screen</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar-hit-test@1.0.2/ar-hit-test.min.js"></script>
  </head>

  <body style="margin:0; overflow:hidden;">
    <a-scene
      xr-mode-ui="enabled: true"
      webxr="optionalFeatures: hit-test"
      ar-hit-test
      vr-mode-ui="enabled: false">

      <!-- Reticle we will manually move to the detected surface -->
      <a-entity
        id="reticle"
        geometry="primitive: ring; radiusInner: 0.04; radiusOuter: 0.06"
        material="shader: flat"
        rotation="-90 0 0"
        visible="false">
      </a-entity>

      <!-- Your model -->
      <a-entity
        id="screen"
        gltf-model="screen.glb"
        visible="false"
        scale="0.08 0.08 0.08">
      </a-entity>

      <a-camera></a-camera>

      <script>
        const scene = document.querySelector("a-scene");
        const reticle = document.querySelector("#reticle");
        const model = document.querySelector("#screen");

        // ar-hit-test (from the CDN script) emits events + provides hit pose data.
        // We’ll listen for hit results and move the reticle there.
        scene.addEventListener("ar-hit-test-select", () => {
          // Fallback event; some builds use select to place — we’ll handle click below too.
        });

        // This event name can vary slightly by build; these two cover most cases.
        scene.addEventListener("ar-hit-test-achieved", (e) => {
          reticle.setAttribute("visible", "true");
        });

        scene.addEventListener("ar-hit-test-lost", () => {
          reticle.setAttribute("visible", "false");
        });

        // Every frame, if hit-test is running, update reticle from hit-test pose
        scene.addEventListener("loaded", () => {
          scene.addEventListener("ar-hit-test-update", (e) => {
            // e.detail.position & e.detail.rotation are provided by ar-hit-test
            if (!e.detail) return;
            reticle.object3D.position.copy(e.detail.position);
            reticle.object3D.quaternion.copy(e.detail.rotation);
            reticle.setAttribute("visible", "true");
          });
        });

        // Tap/click to place model where reticle is
        const place = () => {
          if (!reticle.object3D.visible) return;

          model.object3D.position.copy(reticle.object3D.position);
          model.object3D.quaternion.copy(reticle.object3D.quaternion);
          model.setAttribute("visible", "true");
        };

        document.addEventListener("click", place);
        document.addEventListener("touchend", place, { passive: true });
      </script>
    </a-scene>
  </body>
</html>
